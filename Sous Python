
#Permet de trouver la valeur manquante apr�s la conversion d'un fichier txt 
#en xlrd de solario (sous mac)

import xlrd
import numpy

 
document = xlrd.open_workbook("Mars_Fevrier.xlsx")
 
print("Nombre de feuilles: "+str(document.nsheets))
print("Noms des feuilles: "+str(document.sheet_names()))
feuille_1 = document.sheet_by_index(0)
print("Format de la feuille 1:")
print("Nom: "+str(feuille_1.name))
print("Nombre de lignes: "+str(feuille_1.nrows))
print("Nombre de colonnes: "+str(feuille_1.ncols))
 
cols = feuille_1.ncols
rows = feuille_1.nrows
 
#Variables
X =[]
Y= []
a =[]
b = []
e = 0
f=[]


#c nous permettra de comparer avec les minutes
c=numpy.linspace(0,9,10)

 
for r in range(0, rows):
    X.append(feuille_1.cell_value(rowx=r, colx=0))
  
#séparation date et heure du coup le nombre de valeur est doublé    
for i in range(len(X)):
    a +=X[i].split()
    
    
#on doit prendre les indices impair pour avoir les heures
for i in range(1,len(a),2):
    b +=  a[i].split() 
    
#comparaison : 

for i in range(len(b)):


    if float(b[i][4]) == c[e]:
        if c[e] == 9 : 
            e = 0
        else:
            e += 1
            
    else: 
      f.append(i) 
      if c[e] == 9 : 
            e = 1 
      elif c[e] == 8  :
            e = 0
      else: 
             e += 2 

print(f)
 























